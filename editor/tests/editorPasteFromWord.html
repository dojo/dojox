<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-type" content="text/html; charset=utf-8">
	<title>ADP PasteFromWord Editor Plugin</title>
	<link id="themeStyles" rel="stylesheet" href="../../../../../dijit/themes/claro/document.css"/>
	<link id="themeStyles" rel="stylesheet" href="../../../../../dijit/themes/claro/claro.css"/>
	<style type="text/css">
		#editor{
			margin: 20px;
			width: 500px;
		}
		#devFields{
			position: absolute;
			left: 530px;
			top:20px;
		}
		#devFields label{
			display: block;
		}
		#before, #after{
			width: 400px;
			height: 250px;
			margin-bottom: 20px;
		}
	</style>

	<script>
		dojoConfig = {
			async:true,
			isDebug:true
		};
	</script>
	<script type="text/javascript" src="../../../../../dojo/dojo.js" ></script>

</head>
<body class="claro">

	<div>
		<div id="editor" data-dojo-type="dijit/Editor"
			data-dojo-props='extraPlugins:["viewSource", {name:"pasteFromWord", useWordBullets:false}], height:"400px"'>
		</div>
		<div id="devFields">
			<label>Content during <code>onBeforePasteModified</code></label>
			<textarea id="before"></textarea>
			<label>Content during <code>onPaste</code></label>
			<textarea id="after"></textarea>
		</div>
	</div>

	<script>
		require([
			"dojo/parser",
			"dijit/registry",
			"dojox/html/format",
			"dojo/dom",
			"dojo/aspect",
			"dijit/Editor",
			"dijit/_editor/plugins/ViewSource",
			"dojox/editor/plugins/PasteFromWord"
		], function(parser, registry, format, dom, aspect){

			parser.parse().then(function(){
				var editor = registry.byId('editor');

				aspect.after(editor, 'onBeforePasteModified', function(event){
					//console.log('onBeforePasteModified ', event.value);
					dom.byId('before').value = format.prettyPrint(event.value);
				}, true);
				aspect.after(editor, 'onPaste', function(event){
					//console.log('onPaste ', event.value);
					dom.byId('after').value = format.prettyPrint(event.value);
				}, true);
			});
		});
	</script>

</body>
</html>
